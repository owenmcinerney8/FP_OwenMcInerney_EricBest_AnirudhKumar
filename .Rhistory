EV_ownership_region_year_raw <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(region, year, value) %>%
group_by(region, year) %>%
summarise(count = sum(value))
# wrangled data to cases of years with attributes: year, count of EVs
EV_ownership_global_year <- EV_ownership_region_year_raw %>%
group_by(year) %>%
summarise(count = sum(count))
# CREATE Bar Chart of Global EV Ownership by Year ----------------------------
global_ev_ownership_by_year_bar_chart <- ggplot(EV_ownership_global_year, aes(x = year, y = count, fill = "red")) +
geom_col() +
scale_y_continuous(n.breaks = 8, limits = c(0, max(EV_production_global_year$count))) +
scale_x_continuous(n.breaks = 11) +
labs(
title = "Global EV Ownership since 2010",
x = "Year",
y = "Count of Electric Vehicles"
) +
theme_classic() +
# removes legend
theme(legend.position = "none")
#---------------------
#-Data Visualizations-
#---------------------
# Please see Q0Notes_and_Ideas.txt for additional data questions and project documentation
# Question 6: How do EV MPG compare to Gas MPG?
# Load Packages --------------------------------------------------------------
# Use groundhog to make sure the code runs mostly everywhere
library(groundhog)
groundhog.day <- "2023-11-20"
pkgs <- c("readxl", "dplyr", "dbplyr", "ggplot2", "tidyverse", "knitr", "kableExtra")
groundhog.library(pkgs, groundhog.day)
# Load Data ---------------------------------------------------------------
EV_GAS_data_raw <- read_excel("all_alpha_24.xlsx")
# Wrangle Data ---------------------------------------------------------------
# Wrangle data to include Model, fuel, veh_class, air pollution score, city mpg, highway mpg, greenhouse gas score
# Change names of columns with spaces
colnames(EV_GAS_data_raw)[11] <- "veh_class"
colnames(EV_GAS_data_raw)[12] <- "air_pollution_score"
colnames(EV_GAS_data_raw)[13] <- "city_mpge"
colnames(EV_GAS_data_raw)[14] <- "highway_mpge"
colnames(EV_GAS_data_raw)[15] <- "cmb_mpge"
colnames(EV_GAS_data_raw)[16] <- "greenhouse_gas_score"
# Select to Model, fuel, veh_class, air pollution score, city mpg, highway mpg, greenhouse gas score
EV_GAS_data <- EV_GAS_data_raw %>%
drop_na(city_mpge) %>%
filter(Fuel == "Gasoline" | Fuel == "Electricity") %>%
select(Model, Fuel, veh_class, air_pollution_score, city_mpge,
highway_mpge, cmb_mpge, greenhouse_gas_score) %>%
mutate(
city_mpge = as.numeric(city_mpge),
highway_mpge = as.numeric(highway_mpge),
greenhouse_gas_score = as.numeric(greenhouse_gas_score)
)
# Make Box Plots / Greenhouse Summary Table ----------------------------------
# City MPG Box Plot
city_mpge_box_plot <- EV_GAS_data %>%
group_by(Fuel) %>%
ggplot(aes(x = Fuel, y = city_mpge, group = Fuel, fill = Fuel)) +
labs(title = "City MPGe EV vs Gas Box Plot", subtitle = "MPGe is Miles per Gallon equivalent", x = "Fuel", y = "MPGe") +
scale_y_continuous(n.breaks = 10, limits = c(0, max(EV_GAS_data$city_mpge))) +
geom_boxplot(
outlier.colour = "black", outlier.shape = 16,
outlier.size = 2, notch = FALSE
) +
theme_minimal()
# Highway MPG Box Plot
highway_mpge_box_plot <- EV_GAS_data %>%
group_by(Fuel) %>%
ggplot(aes(x = Fuel, y = highway_mpge, group = Fuel, fill = Fuel)) +
labs(title = "Highway MPGe EV vs Gas Box Plot", subtitle = "MPGe is Miles per Gallon equivalent", x = "Fuel", y = "MPGe") +
scale_y_continuous(n.breaks = 10, limits = c(0, max(EV_GAS_data$highway_mpge))) +
geom_boxplot(
outlier.colour = "black", outlier.shape = 16,
outlier.size = 2, notch = FALSE
) +
theme_minimal()
# Greenhouse Gas Score Summary Table
funx <- list(
min = ~ min(.x, na.rm = TRUE),
Q1 = ~ quantile(.x, probs = 0.20, na.rm = TRUE),
Q2 = ~ quantile(.x, probs = 0.40, na.rm = TRUE),
median = ~ median(.x, na.rm = TRUE),
Q3 = ~ quantile(.x, probs = 0.60, na.rm = TRUE),
Q4 = ~ quantile(.x, probs = 0.80, na.rm = TRUE),
max = ~ max(.x, na.rm = TRUE),
mean = ~ mean(.x, na.rm = TRUE),
std = ~ sd(.x, na.rm = TRUE)
)
green_house_gas_data <- EV_GAS_data %>%
group_by(Fuel) %>%
select(Fuel, greenhouse_gas_score) %>%
summarize(
across(
.cols = where(is.numeric),
.fns = funx
),
count = n()
)
greenhouse_gas_score_summary_table <- green_house_gas_data %>%
kable() %>%
kable_classic()
### View Data Visualizations ---------------------------------------------------
city_mpge_box_plot
highway_mpge_box_plot
greenhouse_gas_score_summary_table
#---------------------
#-Data Visualizations-
#---------------------
# Please see Q0Notes_and_Ideas.txt for additional data questions and project documentation
# Question 7: How do EV's and ICE cars compare in terms of miles driven per dollar for fuel/electricity?
# Load Packages --------------------------------------------------------------
# Use groundhog to make sure the code runs mostly everywhere
library(groundhog)
groundhog.day <- "2023-11-20"
pkgs <- c("readxl", "dplyr", "dbplyr", "ggplot2", "tidyverse", "knitr", "kableExtra")
groundhog.library(pkgs, groundhog.day)
# Read Data ---------------------------------------------------------------
gas_prices <- read_excel("bls_gas_prices.xlsx", range = "B11:M11", col_names = FALSE)
electricty_prices <- read_excel("bls_electricity_prices.xlsx", range = "B11:M11", col_names = FALSE)
EV_GAS_data_raw <- read_excel("all_alpha_24.xlsx")
# Wrangle Data
# Change names of columns with spaces
colnames(EV_GAS_data_raw)[11] <- "veh_class"
colnames(EV_GAS_data_raw)[12] <- "air_pollution_score"
colnames(EV_GAS_data_raw)[13] <- "city_mpge"
colnames(EV_GAS_data_raw)[14] <- "highway_mpge"
colnames(EV_GAS_data_raw)[15] <- "cmb_mpge"
colnames(EV_GAS_data_raw)[16] <- "greenhouse_gas_score"
# Select to Model, fuel, veh_class, air pollution score, city mpg, highway mpg, greenhouse gas score
EV_GAS_data <- EV_GAS_data_raw %>%
drop_na(cmb_mpge) %>%
filter(Fuel == "Gasoline" | Fuel == "Electricity") %>%
select(Model, Fuel, veh_class, air_pollution_score, city_mpge, highway_mpge, cmb_mpge, greenhouse_gas_score) %>%
mutate(
city_mpge = as.numeric(city_mpge),
highway_mpge = as.numeric(highway_mpge),
cmb_mpge = as.numeric(cmb_mpge),
greenhouse_gas_score = as.numeric(greenhouse_gas_score)
)
# Case: fuel with attributes each month, type of fuel, average mpge of a 2024 car
electricty_prices[1:12] = electricty_prices[1:12] * 33.7 # converts from kWh to kWh equivalent of a gallon
fuel_df = full_join(gas_prices, electricty_prices)
colnames(fuel_df)[1] <- "jan"
colnames(fuel_df)[2] <- "feb"
colnames(fuel_df)[3] <- "mar"
colnames(fuel_df)[4] <- "apr"
colnames(fuel_df)[5] <- "may"
colnames(fuel_df)[6] <- "jun"
colnames(fuel_df)[7] <- "jul"
colnames(fuel_df)[8] <- "aug"
colnames(fuel_df)[9] <- "sep"
colnames(fuel_df)[10] <- "oct"
colnames(fuel_df)[11] <- "nov"
colnames(fuel_df)[12] <- "dec"
# Finding relevant data --------------------------------------------------------------
mpge_avg_fuel <- EV_GAS_data %>%
group_by(Fuel) %>%
summarise(mpge_avg = mean(cmb_mpge))
electricity_price_per_mile <- mpge_avg_fuel %>%
filter(Fuel == "Electricity") %>%
select(mpge_avg)
gas_price_per_mile <- mpge_avg_fuel %>%
filter(Fuel == "Gasoline") %>%
select(mpge_avg)
electricity_avg_mpge <- as.numeric(electricity_price_per_mile)
gas_avg_mpge <- as.numeric(gas_price_per_mile)
mpge_avg_fuel
electricity_price_per_mile
fuel_df$type = c("gas", "electricity")
fuel_df <- fuel_df %>%
pivot_longer(cols = c(jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec),
names_to = "month",
values_to = "avg_gallon_equaivalent_price") %>%
pivot_wider(id_cols = month, names_from = type, values_from = avg_gallon_equaivalent_price)
dates <- append(seq(from = as.Date("2022-01-01"), to = as.Date("2022-12-01"), by = 'month'), seq(from = as.Date("2022-01-01"), to = as.Date("2022-12-01"), by = 'month'))
fuel_df$date = dates
#---------------------
#-Data Visualizations-
#---------------------
# Please see Q0Notes_and_Ideas.txt for additional data questions and project documentation
# Question 4: How has global EV usage changed over the years?
# Question 5: Which countries lead in EV usage?  Which countries are lagging behind?
# Load Packages --------------------------------------------------------------
# Use groundhog to make sure the code runs mostly everywhere
library(groundhog)
groundhog.day <- "2023-11-20"
pkgs <- c("here", "dplyr", "dbplyr", "ggplot2")
groundhog.library(pkgs, groundhog.day)
# Load Data ------------------------------------------------------------------
# Using 'here' for a relative file path
# Ensures scientific notation is not used
options(scipen = 999)
csv_path <- here("IEA_EV_SalesHistoricalCars.csv")
EV_Global_Historical_raw <- read.csv(csv_path)
# Wrangle Data ---------------------------------------------------------------
# Wrangle data to include columns for: year, region, count of EVs
EV_ownership_region_year_raw <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(region, year, value) %>%
group_by(region, year) %>%
summarise(count = sum(value))
# wrangled data to cases of years with attributes: year, count of EVs
EV_ownership_global_year <- EV_ownership_region_year_raw %>%
group_by(year) %>%
summarise(count = sum(count))
# CREATE Bar Chart of Global EV Ownership by Year ----------------------------
global_ev_ownership_by_year_bar_chart <- ggplot(EV_ownership_global_year, aes(x = year, y = count, fill = "red")) +
geom_col() +
scale_y_continuous(n.breaks = 8, limits = c(0, max(EV_production_global_year$count))) +
scale_x_continuous(n.breaks = 11) +
labs(
title = "Global EV Ownership since 2010",
x = "Year",
y = "Count of Electric Vehicles"
) +
theme_classic() +
# removes legend
theme(legend.position = "none")
#---------------------
#-Data Visualizations-
#---------------------
# Please see Q0Notes_and_Ideas.txt for additional data questions and project documentation
# Question 7: How do EV's and ICE cars compare in terms of miles driven per dollar for fuel/electricity?
# Load Packages --------------------------------------------------------------
# Use groundhog to make sure the code runs mostly everywhere
library(groundhog)
groundhog.day <- "2023-11-20"
pkgs <- c("readxl", "dplyr", "dbplyr", "ggplot2", "tidyverse", "knitr", "kableExtra")
groundhog.library(pkgs, groundhog.day)
# Read Data ---------------------------------------------------------------
gas_prices <- read_excel("bls_gas_prices.xlsx", range = "B11:M11", col_names = FALSE)
electricty_prices <- read_excel("bls_electricity_prices.xlsx", range = "B11:M11", col_names = FALSE)
EV_GAS_data_raw <- read_excel("all_alpha_24.xlsx")
# Wrangle Data
# Change names of columns with spaces
colnames(EV_GAS_data_raw)[11] <- "veh_class"
colnames(EV_GAS_data_raw)[12] <- "air_pollution_score"
colnames(EV_GAS_data_raw)[13] <- "city_mpge"
colnames(EV_GAS_data_raw)[14] <- "highway_mpge"
colnames(EV_GAS_data_raw)[15] <- "cmb_mpge"
colnames(EV_GAS_data_raw)[16] <- "greenhouse_gas_score"
# Select to Model, fuel, veh_class, air pollution score, city mpg, highway mpg, greenhouse gas score
EV_GAS_data <- EV_GAS_data_raw %>%
drop_na(cmb_mpge) %>%
filter(Fuel == "Gasoline" | Fuel == "Electricity") %>%
select(Model, Fuel, veh_class, air_pollution_score, city_mpge, highway_mpge, cmb_mpge, greenhouse_gas_score) %>%
mutate(
city_mpge = as.numeric(city_mpge),
highway_mpge = as.numeric(highway_mpge),
cmb_mpge = as.numeric(cmb_mpge),
greenhouse_gas_score = as.numeric(greenhouse_gas_score)
)
# Case: fuel with attributes each month, type of fuel, average mpge of a 2024 car
electricty_prices[1:12] = electricty_prices[1:12] * 33.7 # converts from kWh to kWh equivalent of a gallon
fuel_df = full_join(gas_prices, electricty_prices)
colnames(fuel_df)[1] <- "jan"
colnames(fuel_df)[2] <- "feb"
colnames(fuel_df)[3] <- "mar"
colnames(fuel_df)[4] <- "apr"
colnames(fuel_df)[5] <- "may"
colnames(fuel_df)[6] <- "jun"
colnames(fuel_df)[7] <- "jul"
colnames(fuel_df)[8] <- "aug"
colnames(fuel_df)[9] <- "sep"
colnames(fuel_df)[10] <- "oct"
colnames(fuel_df)[11] <- "nov"
colnames(fuel_df)[12] <- "dec"
# Finding relevant data --------------------------------------------------------------
mpge_avg_fuel <- EV_GAS_data %>%
group_by(Fuel) %>%
summarise(mpge_avg = mean(cmb_mpge))
electricity_price_per_mile <- mpge_avg_fuel %>%
filter(Fuel == "Electricity") %>%
select(mpge_avg)
gas_price_per_mile <- mpge_avg_fuel %>%
filter(Fuel == "Gasoline") %>%
select(mpge_avg)
electricity_avg_mpge <- as.numeric(electricity_price_per_mile)
gas_avg_mpge <- as.numeric(gas_price_per_mile)
mpge_avg_fuel
electricity_price_per_mile
fuel_df$type = c("gas", "electricity")
fuel_df <- fuel_df %>%
pivot_longer(cols = c(jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec),
names_to = "month",
values_to = "avg_gallon_equaivalent_price") %>%
pivot_wider(id_cols = month, names_from = type, values_from = avg_gallon_equaivalent_price)
dates <- append(seq(from = as.Date("2022-01-01"), to = as.Date("2022-12-01"), by = 'month'), seq(from = as.Date("2022-01-01"), to = as.Date("2022-12-01"), by = 'month'))
fuel_df$date = dates
knitr::opts_chunk$set(echo = FALSE)
# Style of Choice -- TidyVerse Styling
library(groundhog)
groundhog.day <- "2023-11-20"
pkgs <- c("here", "dplyr", "dbplyr", "ggplot2", "readxl", "tidyverse", "knitr", "kableExtra", "leaflet")
groundhog.library(pkgs, groundhog.day)
# Ensures scientific notation is not used
options(scipen = 999)
# Alternative Fueling Stations Data for Q1
csv_path <- here("EVfuelstations.csv")
EVfuelstations <- read.csv(csv_path)
# EVcars Data for Q2
csv_path <- here("EVcars.csv")
EVcars <- read.csv(csv_path)
# Dataset for Q3
# IEA csv File for Q4 and Q5
csv_path <- here("IEA_EV_SalesHistoricalCars.csv")
EV_Global_Historical_raw <- read.csv(csv_path)
# US department of Energy xlsx File for Q6
EV_GAS_data_raw <- read_excel("all_alpha_24.xlsx")
# BLS Data on Fuel Prices xlsx File for Q7
gas_prices <- read_excel("bls_gas_prices.xlsx", range = "B11:M11", col_names = FALSE)
electricty_prices <- read_excel("bls_electricity_prices.xlsx", range = "B11:M11", col_names = FALSE)
# Wrangle Data ---------------------------------------------------------------
# Q1: How common are charging stations in Pennsylvania for public use?
filtered_stations <- EVfuelstations %>%
filter(Fuel.Type.Code == "ELEC") %>%
filter(State == "PA") %>%
filter(Groups.With.Access.Code == 'Public')
# Printing the number of stations in Pennsylvania
num_stations <- nrow(filtered_stations)
print("Number of Public EV Charging Stations in PA:")
print(num_stations)
# The station names and coordinates are easily selected
stationNames <- filtered_stations$Station.Name
latitude <- filtered_stations$Latitude
longitude <- filtered_stations$Longitude
# Create a custom data frame with station coordinates and names
# Leaflet is sensitive to large datasets
station_data <- data.frame(
Name <- stationNames,
Latitude <- latitude,
Longitude <- longitude
)
# Q2: What vehicle has the longest excursion time/length on a full-charge?
# We have a lot of attributes to pull in. They are as follows:
EVcars_tidy <- EVcars %>%
filter(Fuel.ID == 41) %>%
select(Automobile.ID, Fuel, Manufacturer.ID, Manufacturer, Model,
Model.Year,Category.ID, Engine.Type, Engine.Size, Transmission.Type,
Category, Engine.Size, City.Fuel.Economy.Units, City.Fuel.Economy,
Highway.Fuel.Economy.Units, Highway.Fuel.Economy)
# filters to cases where fuel economy is measured in mpge and is a sedan/wagon
EVcars_mpge <- EVcars_tidy %>%
filter(City.Fuel.Economy.Units == 'mpge')
# Q3: How do EV manufacturers compare in excursion range and vehicle price?
# [Placeholder Wrangling Code]
# Q4: wrangle IEA data to cases of years with attributes: year, count of EVs
EV_supply_global_year <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(year, value) %>%
group_by(year) %>%
summarise(count = sum(value))
#  Q5: wrangle IEA data to get cases of regions from 2019-2022 with attributes: region, count of EVs
EV_supply_region_2019_2022 <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World", year >= 2019) %>%
select(region, value) %>%
group_by(region) %>%
summarise(count = sum(value))
# Q6: US department of energy data: only want to include Model, fuel, veh_class, air pollution score, city mpg, highway mpg,  greenhouse gas score
# Change names of columns with spaces
colnames(EV_GAS_data_raw)[11] <- "veh_class"
colnames(EV_GAS_data_raw)[12] <- "air_pollution_score"
colnames(EV_GAS_data_raw)[13] <- "city_mpge"
colnames(EV_GAS_data_raw)[14] <- "highway_mpge"
colnames(EV_GAS_data_raw)[15] <- "cmb_mpge"
colnames(EV_GAS_data_raw)[16] <- "greenhouse_gas_score"
# Cases are cars with attributes: Model, fuel, vehicle class, air pollution score, city mpg, highway mpg, greenhouse gas score
EV_GAS_data <- EV_GAS_data_raw %>%
drop_na(city_mpge) %>%
filter(Fuel == "Gasoline" | Fuel == "Electricity") %>%
select(Model, Fuel, veh_class, air_pollution_score, city_mpge, highway_mpge, cmb_mpge, greenhouse_gas_score) %>%
mutate(
city_mpge = as.numeric(city_mpge),
highway_mpge = as.numeric(highway_mpge),
cmb_mpge = as.numeric(cmb_mpge),
greenhouse_gas_score = as.numeric(greenhouse_gas_score)
)
# Q7: BLS Data + US department of energy data: case = a month with attribute: month, miles per gallon equivalent for fuel and electricity
electricty_prices[1:12] <- electricty_prices[1:12] * 33.7 # converts from kWh to kWh equivalent of a gallon
fuel_df <- full_join(gas_prices, electricty_prices)
# Currently have each month as a given column: need to label columns
colnames(fuel_df)[1] <- "jan"
colnames(fuel_df)[2] <- "feb"
colnames(fuel_df)[3] <- "mar"
colnames(fuel_df)[4] <- "apr"
colnames(fuel_df)[5] <- "may"
colnames(fuel_df)[6] <- "jun"
colnames(fuel_df)[7] <- "jul"
colnames(fuel_df)[8] <- "aug"
colnames(fuel_df)[9] <- "sep"
colnames(fuel_df)[10] <- "oct"
colnames(fuel_df)[11] <- "nov"
colnames(fuel_df)[12] <- "dec"
# To find average mpge for gas and electric
mpge_avg_fuel <- EV_GAS_data %>%
group_by(Fuel) %>%
summarise(mpge_avg = mean(cmb_mpge))
electricity_price_per_mile <- mpge_avg_fuel %>%
filter(Fuel == "Electricity") %>%
select(mpge_avg)
gas_price_per_mile <- mpge_avg_fuel %>%
filter(Fuel == "Gasoline") %>%
select(mpge_avg)
# Make sure they are numeric
electricity_avg_mpge <- as.numeric(electricity_price_per_mile)
gas_avg_mpge <- as.numeric(gas_price_per_mile)
# Add fuel type column to data frame
fuel_df$type <- c("gas", "electricity")
# Need to change cases to months
fuel_df <- fuel_df %>%
pivot_longer(
cols = c(jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec),
names_to = "month",
values_to = "avg_gallon_equaivalent_price"
)
# Making actual dates instead of character dates
dates <- append(
seq(from = as.Date("2022-01-01"), to = as.Date("2022-12-01"), by = "month"),
seq(from = as.Date("2022-01-01"), to = as.Date("2022-12-01"), by = "month")
)
# Add dates column to fuel_df
fuel_df$date <- dates
# do not need month column anymore, want to mutate from avg price per gallon to miles per dollar
fuel_df <- fuel_df %>%
select(type, avg_gallon_equaivalent_price, date) %>%
mutate(miles_per_dollar = case_when(
type == "gas" ~ gas_avg_mpge / avg_gallon_equaivalent_price,
type == "electricity" ~ electricity_avg_mpge / avg_gallon_equaivalent_price
)) %>%
select(date, type, miles_per_dollar)
# Create the leaflet map
EVchargemap <- leaflet(station_data) %>%
setView(lng = -77.8124, lat = 40.86833, zoom = 6) %>%
addTiles() %>%
addMarkers(lat = ~Latitude, lng = ~Longitude, popup = ~Name)
# Display the map
EVchargemap
funx <- list(
min = ~min(.x, na.rm = TRUE),
Q1 = ~quantile(.x, probs = 0.20, na.rm = TRUE),
Q2 = ~quantile(.x, probs = 0.40, na.rm = TRUE),
median = ~median(.x, na.rm = TRUE),
Q3 = ~quantile(.x, probs = 0.60, na.rm = TRUE),
Q4 = ~quantile(.x, probs = 0.80, na.rm = TRUE),
max = ~max(.x, na.rm = TRUE),
mean = ~mean(.x, na.rm = TRUE),
std = ~sd(.x, na.rm = TRUE)
)
EVcars_mpge_CityHighway_FiveNumSum <- EVcars_mpge %>%
group_by(Category) %>%
select(Category, City.Fuel.Economy, Highway.Fuel.Economy) %>%
summarize(
across(
.cols=where(is.numeric),
.fns = funx),
count =n()
)
# Display Table ---------------------------
EVcars_mpge_CityHighway_FiveNumSum %>%
kable() %>%
kableExtra::kable_classic()
esquisser(data = EVcars_mpge, viewer = getOption(x, default = "dialog"))
#---------------------
#-Data Visualizations-
#---------------------
# Please see Q0Notes_and_Ideas.txt for additional data questions and project documentation
# Question 2: What vehicle has the longest excursion time/length on a full-charge?
# Package and Filepath Configuration ---------------------------
library(groundhog)
groundhog.day="2023-11-20"
pkgs=c('dplyr', 'ggplot2', 'knitr', 'here', 'leaflet', 'kableExtra')
groundhog.library(pkgs, groundhog.day)
csv_path <- here("EVcars.csv")
EVcars <- read.csv(csv_path)
# Data Wrangling ---------------------------
EVcars_tidy <- EVcars %>%
filter(Fuel.ID == 41) %>%
select(Automobile.ID, Fuel, Manufacturer.ID, Manufacturer, Model,
Model.Year,Category.ID, Engine.Type, Engine.Size, Transmission.Type,
Category, Engine.Size, City.Fuel.Economy.Units, City.Fuel.Economy,
Highway.Fuel.Economy.Units, Highway.Fuel.Economy)
# filters to cases where fuel economy is measured in mpge and is a sedan/wagon
EVcars_mpge <- EVcars_tidy %>%
filter(City.Fuel.Economy.Units == 'mpge')
# Table Formatting ---------------------------
funx <- list(
min = ~min(.x, na.rm = TRUE),
Q1 = ~quantile(.x, probs = 0.20, na.rm = TRUE),
Q2 = ~quantile(.x, probs = 0.40, na.rm = TRUE),
median = ~median(.x, na.rm = TRUE),
Q3 = ~quantile(.x, probs = 0.60, na.rm = TRUE),
Q4 = ~quantile(.x, probs = 0.80, na.rm = TRUE),
max = ~max(.x, na.rm = TRUE),
mean = ~mean(.x, na.rm = TRUE),
std = ~sd(.x, na.rm = TRUE)
)
EVcars_mpge_CityHighway_FiveNumSum <- EVcars_mpge %>%
group_by(Category) %>%
select(Category, City.Fuel.Economy, Highway.Fuel.Economy) %>%
summarize(
across(
.cols=where(is.numeric),
.fns = funx),
count =n()
)
# Display Table ---------------------------
EVcars_mpge_CityHighway_FiveNumSum %>%
kable() %>%
kableExtra::kable_classic()
esquisser(data = EVcars_mpge, viewer = getOption(x, default = "dialog"))
