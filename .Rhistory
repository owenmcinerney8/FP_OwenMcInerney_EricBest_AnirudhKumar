x = "Top 3", y = "Percentage of World's EVs Owned") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage of World's EVs Owned") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = percent, y = percent), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage of World's EVs Owned") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = percent, y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage of World's EVs Owned") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = percent, y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = round(percent), y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = as.character(round(percent))+"%", y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = round(percent) + "%", y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = str(round(percent)) + "%", y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = round(percent), y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
top_vs_bottom_percent
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = round(percent, digits = 2), y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
### Load Packages
## Use groundhog to make sure the code runs mostly everywhere
library(groundhog)
groundhog.day="2023-11-20"
pkgs=c('here', 'dplyr', 'dbplyr', 'ggplot2')
groundhog.library(pkgs, groundhog.day)
### Load Data
## Using 'here' for a relative file path
options(scipen = 999) # Ensures scientific notation is not used
csv_path <- here("IEA_EV_SalesHistoricalCars.csv")
EV_Global_Historical_raw <- read.csv(csv_path)
### Wrangle Data
## wrangle data to include columns for: year, region, count of EVs
EV_ownership_region_year_raw <- EV_Global_Historical_raw %>%
filter(unit == 'Vehicles', region != "World") %>%
select(region, year, value) %>%
group_by(region, year) %>%
summarise(count = sum(value))
## wrangled data to cases of years with attributes: year, count of EVs
EV_ownership_global_year <- EV_ownership_region_year_raw %>%
group_by(year) %>%
summarise(count = sum(count))
### CREATE Bar Chart of Global EV Ownership by Year
global_ev_ownership_by_year_bar_chart <- ggplot(EV_ownership_global_year, aes(x = year, y = count, fill = 'red')) +
geom_col() +
scale_y_continuous(n.breaks = 8, limits = c(0, max(EV_production_global_year$count))) +
scale_x_continuous(n.breaks = 11) +
labs(title = "Global EV Ownership since 2010",
x = "Year",
y = "Count of Electric Vehicles") +
theme_classic() +
theme(legend.position = "none") # removes legend
global_ev_ownership_by_year_bar_chart # to view bar chart
### Car bar chart of
# Wrangle Data to get cases of regions from 2019-2022 with attributes: region, count
EV_ownership_region_2019_2022 <- EV_ownership_region_year_raw %>%
filter(year >= 2019) %>%
group_by(region) %>%
summarise(count = sum(count))
# use y = reorder(region, +count) to order countries by car ownership
regional_ev_ownership_bar_chart <- ggplot(EV_ownership_region_2019_2022, aes(x = count, y = reorder(region, +count), fill = 'red')) +
geom_col() +
scale_x_continuous(limits = c(0, max(EV_ownership_order_by_country$count)), n.breaks = 6) +
labs(title = "EV Ownership By Region",
subtitle = "Total EVs Owned from 2019 to 2022 for each Region",
x = "Count of Electric Vehicles",
y = "Region") +
theme_classic() +
theme(legend.position = "none") # removes legend
regional_ev_ownership_bar_chart # to view bar chart
### View Charts
global_ev_ownership_by_year_bar_chart
regional_ev_ownership_bar_chart
### Q5 Expansion: What percentage of EVs do the top 3 owning EV countries own?
EV_ownership_region_2019_2022_order_count <- EV_ownership_region_2019_2022[order(EV_ownership_region_2019_2022$count, decreasing = TRUE),]
top_3_count = (sum(EV_ownership_region_2019_2022_order_count[1:3,2])/sum(EV_ownership_region_2019_2022_order_count$count)) * 100
bottom_count = sum(EV_ownership_region_2019_2022_order_count[4:nrow(EV_ownership_region_2019_2022_order_count),2])/sum(EV_ownership_region_2019_2022_order_count$count) * 100
top_3_count
bottom_count
top_vs_bottom_df <- data.frame(Top3 = c('Yes', 'No'), percent = c(top_3_count, bottom_count))
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = round(percent, digits = 2), y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
string(20)
str(20)
as.character(20)
as.character(20) + "%"
paste(as.character(20), "%")
paste(as.character(20), "%", sep = "")
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = paste(as.character(round(percent, digits = 2)), "%", sep=""), y = percent + 2), size = 3) +
labs(title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage") +
scale_y_continuous(n.breaks = 10, limits = c(0,100)) +
theme_bw()
top_vs_bottom_percent
View(top_vs_bottom_df)
### Load Packages
## Use groundhog to make sure the code runs mostly everywhere
library(groundhog)
groundhog.day="2023-11-20"
pkgs=c('readxl', 'dplyr', 'dbplyr', 'ggplot2', 'tidyverse', 'knitr', 'kableExtra')
groundhog.library(pkgs, groundhog.day)
### read in data
EV_GAS_data_raw <- read_excel("all_alpha_24.xlsx")
# Change names of columns with spaces
colnames(EV_GAS_data_raw)[11] = "veh_class"
colnames(EV_GAS_data_raw)[12] = "air_pollution_score"
colnames(EV_GAS_data_raw)[13] = "city_mpge"
colnames(EV_GAS_data_raw)[14] = "highway_mpge"
colnames(EV_GAS_data_raw)[16] = "greenhouse_gas_score"
# Select to Model, fuel, veh_class, air pollution score, city mpg, highway mpg, greenhouse gas score
EV_GAS_data <- EV_GAS_data_raw %>%
drop_na(city_mpge) %>%
filter(Fuel == "Gasoline" | Fuel == "Electricity") %>%
select(Model, Fuel, veh_class, air_pollution_score, city_mpge, highway_mpge, greenhouse_gas_score) %>%
mutate(city_mpge = as.numeric(city_mpge),
highway_mpge = as.numeric(highway_mpge),
greenhouse_gas_score = as.numeric(greenhouse_gas_score))
### Make Box Plots / Greenhouse Summary Table
diamonds
# City MPG Box Plot
city_mpge_box_plot <- EV_GAS_data %>%
group_by(Fuel) %>%
ggplot(aes(x = Fuel, y = city_mpge, group = Fuel, fill = Fuel)) +
labs(title = "City MPGe EV vs Gas Box Plot", subtitle = "MPGe is Miles per Gallon equivalent", x = "Fuel", y = "MPGe") +
scale_y_continuous(n.breaks = 10, limits = c(0, max(EV_GAS_data$city_mpge))) +
geom_boxplot(outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE) +
theme_minimal()
### Make Box Plots / Greenhouse Summary Table
# City MPG Box Plot
city_mpge_box_plot <- EV_GAS_data %>%
group_by(Fuel) %>%
ggplot(aes(x = Fuel, y = city_mpge, group = Fuel, fill = Fuel)) +
labs(title = "City MPGe EV vs Gas Box Plot", subtitle = "MPGe is Miles per Gallon equivalent", x = "Fuel", y = "MPGe") +
scale_y_continuous(n.breaks = 10, limits = c(0, max(EV_GAS_data$city_mpge))) +
geom_boxplot(outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE) +
theme_minimal()
# Highway MPG Box Plot
highway_mpge_box_plot <- EV_GAS_data %>%
group_by(Fuel) %>%
ggplot(aes(x = Fuel, y = highway_mpge, group = Fuel, fill = Fuel)) +
labs(title = "Highway MPGe EV vs Gas Box Plot", subtitle = "MPGe is Miles per Gallon equivalent", x = "Fuel", y = "MPGe") +
scale_y_continuous(n.breaks = 10, limits = c(0, max(EV_GAS_data$highway_mpge))) +
geom_boxplot(outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE) +
theme_minimal()
# Greenhouse Gas Score Summary Table
funx <- list(
min = ~min(.x, na.rm = TRUE),
Q1 = ~quantile(.x, probs = 0.20, na.rm = TRUE),
Q2 = ~quantile(.x, probs = 0.40, na.rm = TRUE),
median = ~median(.x, na.rm = TRUE),
Q3 = ~quantile(.x, probs = 0.60, na.rm = TRUE),
Q4 = ~quantile(.x, probs = 0.80, na.rm = TRUE),
max = ~max(.x, na.rm = TRUE),
mean = ~mean(.x, na.rm = TRUE),
std = ~sd(.x, na.rm = TRUE)
)
green_house_gas_data <- EV_GAS_data %>%
group_by(Fuel) %>%
select(Fuel, greenhouse_gas_score) %>%
summarize(
across(
.cols=where(is.numeric),
.fns = funx),
count =n()
)
greenhouse_gas_score_summary_table <- green_house_gas_data %>%
kable() %>%
kable_classic()
# View Data Visualizations
city_mpge_box_plot
highway_mpge_box_plot
greenhouse_gas_score_summary_table
install.packages("styler")
styler:::set_style_transformers()
styler:::style_active_file()
### read in data
EV_GAS_data_raw <- read_excel("all_alpha_24.xlsx")
# Change names of columns with spaces
colnames(EV_GAS_data_raw)[11] <- "veh_class"
colnames(EV_GAS_data_raw)[12] <- "air_pollution_score"
colnames(EV_GAS_data_raw)[13] <- "city_mpge"
colnames(EV_GAS_data_raw)[14] <- "highway_mpge"
colnames(EV_GAS_data_raw)[16] <- "greenhouse_gas_score"
# Select to Model, fuel, veh_class, air pollution score, city mpg, highway mpg, greenhouse gas score
EV_GAS_data <- EV_GAS_data_raw %>%
drop_na(city_mpge) %>%
filter(Fuel == "Gasoline" | Fuel == "Electricity") %>%
select(Model, Fuel, veh_class, air_pollution_score, city_mpge, highway_mpge, greenhouse_gas_score) %>%
mutate(
city_mpge = as.numeric(city_mpge),
highway_mpge = as.numeric(highway_mpge),
greenhouse_gas_score = as.numeric(greenhouse_gas_score)
)
### Make Box Plots / Greenhouse Summary Table
# City MPG Box Plot
city_mpge_box_plot <- EV_GAS_data %>%
group_by(Fuel) %>%
ggplot(aes(x = Fuel, y = city_mpge, group = Fuel, fill = Fuel)) +
labs(title = "City MPGe EV vs Gas Box Plot", subtitle = "MPGe is Miles per Gallon equivalent", x = "Fuel", y = "MPGe") +
scale_y_continuous(n.breaks = 10, limits = c(0, max(EV_GAS_data$city_mpge))) +
geom_boxplot(
outlier.colour = "black", outlier.shape = 16,
outlier.size = 2, notch = FALSE
) +
theme_minimal()
# Highway MPG Box Plot
highway_mpge_box_plot <- EV_GAS_data %>%
group_by(Fuel) %>%
ggplot(aes(x = Fuel, y = highway_mpge, group = Fuel, fill = Fuel)) +
labs(title = "Highway MPGe EV vs Gas Box Plot", subtitle = "MPGe is Miles per Gallon equivalent", x = "Fuel", y = "MPGe") +
scale_y_continuous(n.breaks = 10, limits = c(0, max(EV_GAS_data$highway_mpge))) +
geom_boxplot(
outlier.colour = "black", outlier.shape = 16,
outlier.size = 2, notch = FALSE
) +
theme_minimal()
# Greenhouse Gas Score Summary Table
funx <- list(
min = ~ min(.x, na.rm = TRUE),
Q1 = ~ quantile(.x, probs = 0.20, na.rm = TRUE),
Q2 = ~ quantile(.x, probs = 0.40, na.rm = TRUE),
median = ~ median(.x, na.rm = TRUE),
Q3 = ~ quantile(.x, probs = 0.60, na.rm = TRUE),
Q4 = ~ quantile(.x, probs = 0.80, na.rm = TRUE),
max = ~ max(.x, na.rm = TRUE),
mean = ~ mean(.x, na.rm = TRUE),
std = ~ sd(.x, na.rm = TRUE)
)
green_house_gas_data <- EV_GAS_data %>%
group_by(Fuel) %>%
select(Fuel, greenhouse_gas_score) %>%
summarize(
across(
.cols = where(is.numeric),
.fns = funx
),
count = n()
)
greenhouse_gas_score_summary_table <- green_house_gas_data %>%
kable() %>%
kable_classic()
# View Data Visualizations
city_mpge_box_plot
highway_mpge_box_plot
greenhouse_gas_score_summary_table
styler:::style_active_file()
pkgs <- c("here", "dplyr", "dbplyr", "ggplot2")
groundhog.library(pkgs, groundhog.day)
### Load Data
## Using 'here' for a relative file path
options(scipen = 999) # Ensures scientific notation is not used
csv_path <- here("IEA_EV_SalesHistoricalCars.csv")
EV_Global_Historical_raw <- read.csv(csv_path)
### Wrangle Data
## wrangle data to include columns for: year, region, count of EVs
EV_ownership_region_year_raw <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(region, year, value) %>%
group_by(region, year) %>%
summarise(count = sum(value))
## wrangled data to cases of years with attributes: year, count of EVs
EV_ownership_global_year <- EV_ownership_region_year_raw %>%
group_by(year) %>%
summarise(count = sum(count))
### CREATE Bar Chart of Global EV Ownership by Year
global_ev_ownership_by_year_bar_chart <- ggplot(EV_ownership_global_year, aes(x = year, y = count, fill = "red")) +
geom_col() +
scale_y_continuous(n.breaks = 8, limits = c(0, max(EV_production_global_year$count))) +
scale_x_continuous(n.breaks = 11) +
labs(
title = "Global EV Ownership since 2010",
x = "Year",
y = "Count of Electric Vehicles"
) +
theme_classic() +
theme(legend.position = "none") # removes legend
global_ev_ownership_by_year_bar_chart # to view bar chart
### Car bar chart of
# Wrangle Data to get cases of regions from 2019-2022 with attributes: region, count
EV_ownership_region_2019_2022 <- EV_ownership_region_year_raw %>%
filter(year >= 2019) %>%
group_by(region) %>%
summarise(count = sum(count))
# use y = reorder(region, +count) to order countries by car ownership
regional_ev_ownership_bar_chart <- ggplot(EV_ownership_region_2019_2022, aes(x = count, y = reorder(region, +count), fill = "red")) +
geom_col() +
scale_x_continuous(limits = c(0, max(EV_ownership_order_by_country$count)), n.breaks = 6) +
labs(
title = "EV Ownership By Region",
subtitle = "Total EVs Owned from 2019 to 2022 for each Region",
x = "Count of Electric Vehicles",
y = "Region"
) +
theme_classic() +
theme(legend.position = "none") # removes legend
regional_ev_ownership_bar_chart # to view bar chart
### View Charts
global_ev_ownership_by_year_bar_chart
regional_ev_ownership_bar_chart
### Q5 Expansion: What percentage of EVs do the top 3 owning EV countries own?
EV_ownership_region_2019_2022_order_count <- EV_ownership_region_2019_2022[order(EV_ownership_region_2019_2022$count, decreasing = TRUE), ]
top_3_count <- (sum(EV_ownership_region_2019_2022_order_count[1:3, 2]) / sum(EV_ownership_region_2019_2022_order_count$count)) * 100
bottom_count <- sum(EV_ownership_region_2019_2022_order_count[4:nrow(EV_ownership_region_2019_2022_order_count), 2]) / sum(EV_ownership_region_2019_2022_order_count$count) * 100
top_3_count
bottom_count
top_vs_bottom_df <- data.frame(Top3 = c("Yes", "No"), percent = c(top_3_count, bottom_count))
top_vs_bottom_percent <- top_vs_bottom_df %>%
ggplot(aes(x = Top3, y = percent, fill = Top3)) +
geom_col() +
geom_text(aes(label = paste(as.character(round(percent, digits = 2)), "%", sep = ""), y = percent + 2), size = 3) +
labs(
title = "Percent of World's EVs Owned", subtitle = "Leading 3 Regions Vs The Rest of the World",
x = "Top 3", y = "Percentage"
) +
scale_y_continuous(n.breaks = 10, limits = c(0, 100)) +
theme_bw()
top_vs_bottom_percent
knitr::opts_chunk$set(echo = TRUE)
## only want to include columns for: year, region, count of EVs
EV_ownership_region_year_raw <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(region, year, value) %>%
group_by(region, year) %>%
summarise(count = sum(value))
## Q4: wrangle data to cases of years with attributes: year, count of EVs
EV_ownership_global_year <- EV_ownership_region_year_raw %>%
group_by(year) %>%
summarise(count = sum(count))
## Q5: wrangle data to get cases of regions from 2019-2022 with attributes: region, count of EVs
EV_ownership_region_2019_2022 <- EV_ownership_region_year_raw %>%
filter(year >= 2019) %>%
group_by(region) %>%
summarise(count = sum(count))
## only want to include columns for: year, region, count of EVs
EV_ownership_region_year_raw <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(region, year, value) %>%
group_by(region, year) %>%
summarise(count = sum(value))
## Q4: wrangle data to cases of years with attributes: year, count of EVs
EV_ownership_global_year <- EV_ownership_region_year_raw %>%
group_by(year) %>%
summarise(count = sum(count))
## Q5: wrangle data to get cases of regions from 2019-2022 with attributes: region, count of EVs
EV_ownership_region_2019_2022 <- EV_ownership_region_year_raw %>%
filter(year >= 2019) %>%
group_by(region) %>%
summarise(count = sum(count))
## Create Bar Chart of Global EV Ownership by Year -----------------------------
global_ev_ownership_by_year_bar_chart <- ggplot(EV_ownership_global_year, aes(x = year, y = count, fill = "red")) +
geom_col() +
scale_y_continuous(n.breaks = 8, limits = c(0, max(EV_production_global_year$count))) +
scale_x_continuous(n.breaks = 11) +
labs(
title = "Global EV Ownership since 2010",
x = "Year",
y = "Count of Electric Vehicles"
) +
theme_classic() +
theme(legend.position = "none") # removes legend
global_ev_ownership_by_year_bar_chart # to view bar chart
## Wrangle Data ----------------------------------------------------------------
# wrangle data to cases of years with attributes: year, count of EVs
EV_ownership_global_year <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(year, value) %>%
group_by(year) %>%
summarise(count = sum(value))
## Create Bar Chart of Global EV Ownership by Year -----------------------------
global_ev_ownership_by_year_bar_chart <- ggplot(EV_ownership_global_year, aes(x = year, y = count, fill = "red")) +
geom_col() +
scale_y_continuous(n.breaks = 8, limits = c(0, max(EV_production_global_year$count))) +
scale_x_continuous(n.breaks = 11) +
labs(
title = "Global EV Ownership since 2010",
x = "Year",
y = "Count of Electric Vehicles"
) +
theme_classic() +
theme(legend.position = "none") # removes legend
global_ev_ownership_by_year_bar_chart # to view bar chart
## Wrangle Data ----------------------------------------------------------------
# wrangle data to cases of years with attributes: year, count of EVs
EV_ownership_global_year <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(year, value) %>%
group_by(year) %>%
summarise(count = sum(value))
## Create Bar Chart of Global EV Ownership by Year -----------------------------
global_ev_ownership_by_year_bar_chart <- ggplot(EV_ownership_global_year, aes(x = year, y = count, fill = "red")) +
geom_col() +
scale_y_continuous(n.breaks = 8, limits = c(0, max(EV_ownership_global_year$count))) +
scale_x_continuous(n.breaks = 11) +
labs(
title = "Global EV Ownership since 2010",
x = "Year",
y = "Count of Electric Vehicles"
) +
theme_classic() +
theme(legend.position = "none") # removes legend
global_ev_ownership_by_year_bar_chart # to view bar chart
## Wrangle Data
# wrangle data to get cases of regions from 2019-2022 with attributes: region, count of EVs
EV_ownership_region_2019_2022 <- EV_Global_Historical_raw %>%
filter(unit == "Vehicles", region != "World") %>%
select(region, value) %>%
group_by(region) %>%
summarise(count = sum(value))
## Create bar chart of EV Ownership by Country ---------------------------------
# use y = reorder(region, +count) to order countries by car ownership
regional_ev_ownership_bar_chart <- ggplot(EV_ownership_region_2019_2022, aes(x = count, y = reorder(region, +count), fill = "red")) +
geom_col() +
scale_x_continuous(limits = c(0, max(EV_ownership_order_by_country$count)), n.breaks = 6) +
labs(
title = "EV Ownership By Region",
subtitle = "Total EVs Owned from 2019 to 2022 for each Region",
x = "Count of Electric Vehicles",
y = "Region"
) +
theme_classic() +
theme(legend.position = "none") # removes legend
regional_ev_ownership_bar_chart # to view bar chart
regional_ev_ownership_bar_chart
View(EV_GAS_data_raw)
### read in data ---------------------------------------------------------------
gas_prices <- read_excel("bls_gas_prices", range = A11:M11)
